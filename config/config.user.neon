services:
    PermissionObject:
        setup:
            - addResource('Admin:User')
            - addResourceAction('Admin:User', 'default')
            - allow('moderator', 'Admin:User', 'default')
            - addResourceAction('Admin:User', 'show')
            - allow('moderator', 'Admin:User', 'show')
            - addResourceAction('Admin:User', 'create')
            - allow('moderator', 'Admin:User', 'create')
            - addResourceAction('Admin:User', 'edit')
            - allow('moderator', 'Admin:User', 'edit')
            - addResourceAction('Admin:User', 'delete')
            - allow('admin', 'Admin:User', 'delete')

            - addResource('company')
            - addResourceAction('company', 'view')
            - allow('guest', 'company', 'view')
            - addResourceAction('company', 'create')
            - allow('client', 'company', 'create')
            - addResourceAction('company', 'edit')
            - allow('client', 'company', 'edit')
            - addResourceAction('company', 'delete')
            - allow('client', 'company', 'delete')

            - addResource('admin.company')
            - addResourceAction('admin.company', 'view')
            - allow('moderator', 'admin.company', 'view')
            - addResourceAction('admin.company', 'create')
            - allow('moderator', 'admin.company', 'create')
            - addResourceAction('admin.company', 'edit')
            - allow('moderator', 'admin.company', 'edit')
            - addResourceAction('admin.company', 'delete')
            - allow('admin', 'admin.company', 'delete')

    authenticator: Wame\UserModule\Models\Authenticator
    - {class: Wame\UserModule\Models\UserEntityExtensionMethod, tags: [run]}

    # Repositories
    CompanyRepository:
        class: Wame\UserModule\Repositories\CompanyRepository
        inject: yes

    UserRepository:
        class: Wame\UserModule\Repositories\UserRepository
        inject: yes

    UserInCompanyRepository:
        class: Wame\UserModule\Repositories\UserInCompanyRepository
        inject: yes


    # User sing in listener - user redirects
    - {class: Wame\UserModule\Events\SignInListener, tags: [run]}

    - {class: Wame\UserModule\Events\SignUp\CompanyListener, tags: [run]}

    # Components
    - Wame\UserModule\Components\IUserControlFactory
    - Wame\UserModule\Components\IUserListControlFactory
    - Wame\UserModule\Components\IUserEmptyListControlFactory
    - Wame\UserModule\Components\IUserSettingsButtonControlFactory


doctrine:
    metadata:
        Wame\UserModule\Entities: %appDir%/../vendor/wame/UserModule/entities